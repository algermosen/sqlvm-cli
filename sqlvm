#!/bin/bash

VM_IMAGE="$HOME/sqlvm/ubuntu.img"
LOGFILE="$HOME/sqlvm/vm.log"

case "$1" in
  up)
    echo "ðŸŸ¢ Starting SQL VM..."
    nohup qemu-system-x86_64 \
      -m 4096 \
      -smp 2 \
      -cpu qemu64 \
      -nographic \
      -drive file="$VM_IMAGE",format=qcow2 \
      -net nic -net user,hostfwd=tcp::2222-:22,hostfwd=tcp::1433-:1433 \
      > "$LOGFILE" 2>&1 &
    echo "VM started in background. Logs at: $LOGFILE"
    ;;
  down)
    echo "ðŸ”´ Stopping SQL VM..."
    pkill -f qemu-system-x86_64 && echo "VM stopped." || echo "No VM running."
    ;;
  status)
    if pgrep -f qemu-system-x86_64 > /dev/null; then
      echo "ðŸŸ¡ SQL VM is running."
    else
      echo "âš« SQL VM is not running."
    fi
    ;;
  *)
    echo "Usage: sqlvm {up|down|status}"
    ;;
esac

